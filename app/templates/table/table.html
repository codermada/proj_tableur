{% extends "base.html" %} {% block title %} TABLE - {{table.name | upper()}} {%
endblock title %} {% block content %}

<div class="table_container">
  <span class="">
    <a href="{{ url_for('table.index', collection_id=collection.id) }}"
      >{{collection.name}}</a
    >
  </span>
  <div class="">
    {% if table.param_names != None and table.n_col > 0%}
    <div>
      <form
        action="{{ url_for('table.add_record', collection_id=collection.id, table_id=table.id, focused=1) }}"
        method="POST"
      >
        {% for field in table.param_names.split('.')%}
        <input type="text" name="{{field}}" placeholder="{{field}}" />
        {% endfor %}
        <input type="submit" value="add record" />
      </form>
    </div>
    {% endif %}
    <div style="width: 100%; height: 400px">
      <a
        href="{{ url_for('table.delete_table', table_id=table.id, collection_id=collection.id) }}"
        >delete table</a
      >
      {% if table.formula_name == "" %}
      <form
        action="{{ url_for('table.choose_formula', collection_id=collection.id, table_id=table.id) }}"
        method="POST"
      >
        <select name="formula_name">
          {% for formula in formulas %}
          <option value="{{formula.id}}">{{formula.name}}</option>
          {% endfor %}
        </select>
        <input type="submit" value="chose" />
      </form>
      {%else%} {% if table.param_names != None and table.n_col > 0%}
      <form
        action="{{ url_for('table.add_records', collection_id=collection.id, table_id=table.id, focused=1) }}"
        method="POST"
        enctype="multipart/form-data"
      >
        <input type="file" name="filename" />
        <input type="submit" value="load from csv" />
      </form>
      <div class="table_frame focused">{% include "table/_table.html" %}</div>
      {% endif %} {%endif %}
    </div>
  </div>
</div>
{% endblock content %} {% block script %} {{super()}}
<script src=" {{ url_for('static', filename='js/script_table_focused.js') }} "></script>
<script>
  var table2excel = new Table2Excel();

  document.getElementById("export").addEventListener("click", function () {
    table2excel.export(document.querySelectorAll("table"));
  });
</script>
{% endblock %}
